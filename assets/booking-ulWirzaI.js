import"./main-CtkQ6Y3R.js";(()=>{const u="nmd_bookings",d=document.querySelector("[data-booking-form]"),f=document.querySelector("[data-manage-form]"),g=document.querySelector("[data-booking-toast]"),a=document.querySelector("[data-manage-toast]"),l=document.querySelector("[data-reschedule]"),k=document.querySelector("[data-cancel]");function S(){try{const t=localStorage.getItem(u);if(!t)return[];const e=JSON.parse(t);return Array.isArray(e)?e:[]}catch{return[]}}function m(t){localStorage.setItem(u,JSON.stringify(t))}function p(){const t="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let e="";for(let n=0;n<6;n++)e+=t[Math.floor(Math.random()*t.length)];return`NMD-${e}`}function o(t,e){t&&(t.textContent=e,t.hidden=!1,window.clearTimeout(t._t),t._t=window.setTimeout(()=>t.hidden=!0,5500))}d&&d.addEventListener("submit",t=>{t.preventDefault();const e=new FormData(d),n=String(e.get("name")||"").trim(),i=String(e.get("email")||"").trim(),r=String(e.get("service")||"").trim(),c=String(e.get("platform")||"").trim(),s=String(e.get("date")||"").trim(),h=String(e.get("time")||"").trim(),T=String(e.get("notes")||"").trim();if(!n||!i||!r||!c||!s||!h){o(g,"Please complete all required fields.");return}const w=p(),v={ref:w,name:n,email:i,service:r,platform:c,date:s,time:h,notes:T,status:"Reserved"},y=S();y.unshift(v),m(y),d.reset(),o(g,`Reserved. Reference: ${w}. Use this to cancel or reschedule.`)});function b(t){const e=S(),n=e.findIndex(i=>i.ref.toUpperCase()===t.toUpperCase());return n===-1?{list:e,idx:n,booking:null}:{list:e,idx:n,booking:e[n]}}k&&k.addEventListener("click",()=>{if(!f)return;const t=new FormData(f),e=String(t.get("ref")||"").trim();if(!e){o(a,"Enter your booking reference first.");return}const{list:n,idx:i,booking:r}=b(e);if(!r){o(a,"Booking reference not found (demo).");return}n[i]={...r,status:"Cancelled"},m(n),o(a,`Booking ${r.ref} cancelled.`)}),l&&l.addEventListener("click",()=>{if(!f)return;const t=new FormData(f),e=String(t.get("ref")||"").trim(),n=String(t.get("newDate")||"").trim(),i=String(t.get("newTime")||"").trim();if(!e){o(a,"Enter your booking reference first.");return}if(!n&&!i){o(a,"Enter a new date or time to reschedule.");return}const{list:r,idx:c,booking:s}=b(e);if(!s){o(a,"Booking reference not found (demo).");return}if(s.status==="Cancelled"){o(a,"This booking is already cancelled.");return}r[c]={...s,date:n||s.date,time:i||s.time},m(r),o(a,`Booking ${s.ref} rescheduled to ${r[c].date} at ${r[c].time}.`)})})();
